{"version":3,"sources":["country.jsx","typeaheadOptions.jsx","typeahead.jsx","loader.jsx","hooks/useFetch.js","Map.jsx","App.js","constants.js","index.js"],"names":["yieldSelf","n","displayFuncs","toLocaleString","langArr","map","l","name","join","keyDisplayNames","Country","country","console","log","window","Object","entries","k","v","TypeaheadOptions","options","filterValue","filterStr","replaceAll","filter","opt","RegExp","test","filterOptions","value","className","Typeahead","selectedCountry","setSelectedCountry","useState","inputVal","setInputVal","focused","setFocused","inputRef","createRef","onOptionSelection","countryName","tabIndex","type","id","placeholder","onChange","e","target","onKeyDown","key","onKeyPress","onFocus","ref","length","onClick","current","focus","innerText","useFetch","baseUrl","isFetching","setIsFetching","get","url","a","method","headers","finalUrl","fetch","response","json","data","ok","Error","status","Map","latitude","longitude","FlyTo","useMap","zoomLevel","zoomSwitcher","area","flyTo","duration","MapContainer","center","zoom","scrollWheelZoom","TileLayer","attribution","App","countryMap","setCountryMap","_setSelectedCountry","countryNameList","setNameList","toLowerCase","useEffect","fetchCountryList","then","countryList","countries","buildInitialState","res","mapObj","nameList","forEach","push","len","selected","Math","round","random","chooseRandomCountry","selectedCountryObj","latlng","width","src","flag","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.d6703054.chunk.js","sourcesContent":["const yieldSelf = n => n;\n\n// only mapping things I care about displaying\nconst displayFuncs = {\n  \"area\": n => n? n.toLocaleString() + \" kmÂ²\" : \"--\",\n  \"capital\": yieldSelf,\n  \"demonym\": yieldSelf,\n  \"languages\": (langArr) => {\n    const langs = langArr.map(l => l.name);\n    return langs.join(\", \");\n  },\n  \"name\": yieldSelf,\n  \"nativeName\": yieldSelf,\n  \"population\": n => n ? n.toLocaleString() : \"unknown\",\n  \"subregion\": yieldSelf,\n};\n\nconst keyDisplayNames = {\n  \"area\": \"Area\",\n  \"capital\": \"Capital\",\n  \"demonym\": \"Demonym\",\n  \"languages\": \"Languages\",\n  \"name\": \"Name\",\n  \"nativeName\": \"Native Name\",\n  \"population\": \"Population\",\n  \"subregion\": \"Region\",\n};\n\n\nconst Country = ({country}) => {\n  console.log(country);\n  window.country = country;\n  if (!country) return null;\n\n  return (\n    Object.entries(country).map(([k, v]) => {\n      if (k in displayFuncs) {\n        return <p key={k}>{keyDisplayNames[k]}: {displayFuncs[k](v)}</p>\n      } else { return null; }\n    })\n  );\n};\n\nexport default Country;\n","// Uses filter value to display only the options that match\nconst TypeaheadOptions = ({options, filterValue}) => {\n  const filterOptions = () => {\n    if (!filterValue) return options;\n\n    // low-budget string sanitization so '(' don't break the regex\n    let filterStr = filterValue.replaceAll(\"(\", \"\").replaceAll(\")\", \"\");\n    return options.filter(opt => RegExp(filterStr, 'i').test(opt))\n  };\n\n  return (\n    <>\n      {filterOptions().map(opt => (\n        <p value={opt} key={opt} className=\"country-dropdown-option\">{opt}</p>\n      ))}\n    </>\n  );\n};\n\nexport default TypeaheadOptions;\n","import { useState, createRef } from \"react\";\nimport TypeaheadOptions from \"./typeaheadOptions\";\n\nconst Typeahead = ({ options, selectedCountry, setSelectedCountry }) => {\n  const [inputVal, setInputVal] = useState(selectedCountry);\n  const [focused, setFocused] = useState(false);\n  const inputId = \"typeahead-input\";\n\n  const inputRef = createRef();\n\n  const onOptionSelection = (countryName) => {\n    setInputVal(countryName);\n    setSelectedCountry(countryName);\n    setFocused(false);\n  };\n\n  const cancel = () => {\n    setFocused(false);\n  };\n\n  const onChange = (e) => {\n    setInputVal(e.target.value);\n  };\n\n  const onKeyDown = (e) => {\n    if (e.key !== \"Escape\") return;\n    cancel();\n  };\n\n  const onKeyPress = (e) => {\n    if (e.key !== \"Enter\") return;\n    onOptionSelection(inputVal);\n  }\n\n  const clearInput = () => {\n    setInputVal(\"\");\n    inputRef.current.focus();\n  }\n\n  return (\n    <div className=\"typeahead-container\">\n      <input\n        tabIndex=\"1\"\n        type=\"text\"\n        id={inputId}\n        className=\"typeahead-input\"\n        placeholder=\"Choose a country\"\n        value={inputVal}\n        onChange={onChange}\n        onKeyDown={onKeyDown}\n        onKeyPress={onKeyPress}\n        onFocus={() => setFocused(true)}\n        ref={inputRef}\n        // onBlur={onBlur}  onblur intercepts even the onMouseDown?\n      />\n      {inputVal?.length > 0 && (\n        <div\n          className=\"clear-input\"\n          onClick={clearInput}\n        >X</div>\n      )}\n      { focused && (\n        <div\n          className=\"country-dropdown width-100\"\n          onClick={(e) => onOptionSelection(e.target.innerText)}\n        >\n          <TypeaheadOptions options={options} filterValue={inputVal} />\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Typeahead;\n","import \"./loader.css\"\n\nexport default function () {\n  return (\n    <div className=\"loader-container\">\n      <div className=\"lds-ripple\">\n        <div></div>\n        <div></div>\n      </div>\n    </div>\n  );\n}\n","import { useState } from \"react\";\n\nfunction useFetch(baseUrl) {\n  const [isFetching, setIsFetching] = useState(false);\n\n  const get = async (\n    url,\n    method = \"GET\",\n    // headers = { \"Content-Type\": \"application/json\" }, // was causing a CORS error\n    headers = {},\n    options\n  ) => {\n    setIsFetching(true);\n\n    const finalUrl = baseUrl + url;\n\n    try {\n      console.log(\"Fetching url: \", finalUrl);\n      const response = await fetch(finalUrl, { method, headers, ...options });\n\n      const data = await response.json();\n\n      if (!response.ok) {\n        throw new Error(`Request received code: ${response.status}`);\n      }\n\n      return data;\n    } catch (err) {\n      throw(err);\n    } finally {\n      setIsFetching(false);\n    }\n  };\n\n  return {\n    isFetching,\n    get,\n  }\n}\n\nexport default useFetch;\n","import {\n  MapContainer,\n  Marker,\n  Popup,\n  TileLayer,\n  useMap,\n} from \"react-leaflet\";\n\n\nconst Map = ({latitude, longitude, country}) => {\n  const FlyTo = () => {\n    const map = useMap();\n    const zoomLevel = zoomSwitcher(country.area);\n\n    // [lat, lng], zoomLevel, duration in seconds\n    map.flyTo([latitude, longitude], zoomLevel, { duration: 2 })\n\n    return null;\n  };\n\n  const zoomSwitcher = (area) => {\n    if (!area) { return 6; }\n    if (area < 1) { return 12; }\n    if (area < 1000) { return 10; }\n    if (area < 50000) { return 8; }\n    if (area < 100000) { return 7; }\n    if (area < 1000000) { return 6; }\n    if (area <= 10000000) { return 4; }\n    if (area > 10000000) { return 2; }\n  }\n\n  return (\n    <MapContainer\n      center={[latitude, longitude]}\n      zoom={4}\n      scrollWheelZoom={true}\n    >\n      <TileLayer\n        attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n        url=\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\"\n      />\n      <FlyTo />\n      {/*<Marker position={[lat, lng]}>*/}\n      {/*  <Popup>*/}\n      {/*    A pretty CSS3 popup. <br/> Easily customizable.*/}\n      {/*  </Popup>*/}\n      {/*</Marker>*/}\n    </MapContainer>\n  );\n};\n\nexport default Map;\n","import \"./App.css\";\nimport { useEffect, useState } from \"react\";\nimport { API_BASE_URL } from \"./constants\";\nimport Country from \"./country\";\nimport Typeahead from \"./typeahead\";\nimport Loader from \"./loader\";\nimport useFetch from \"./hooks/useFetch\";\nimport Map from \"./Map\";\n\nfunction App() {\n  const [countryMap, setCountryMap] = useState({});\n  const [selectedCountry, _setSelectedCountry] = useState(null);\n  const [countryNameList, setNameList] = useState([]); // for display with proper case\n  const { isFetching, get } = useFetch(`${API_BASE_URL}`);\n\n  // Simple wrapper so we don't have to care about string case\n  const setSelectedCountry = (countryName) => _setSelectedCountry(countryName.toLowerCase());\n\n  useEffect(() => {\n    fetchCountryList()\n      .then((countryList) => {\n        window.countries = countryList; // for dev\n        buildInitialState(countryList)\n      });\n  }, []);\n\n  const fetchCountryList = async () => {\n    const res = await get(\"/all\")\n    return res;\n  }\n\n  const chooseRandomCountry = (countryList) => {\n    const len = countryList.length;\n    const idx = Math.round(Math.random() * len);\n    const selected = countryList[idx]\n    setSelectedCountry(selected.name);\n  };\n\n  const buildInitialState = (countryList) => {\n    const mapObj = {};\n    const nameList = [];\n\n    countryList.forEach(country => {\n      mapObj[country.name.toLowerCase()] = country;\n      nameList.push(country.name);\n    });\n\n    setCountryMap(mapObj);\n    setNameList(nameList);\n    chooseRandomCountry(countryList);\n  };\n\n  const selectedCountryObj = countryMap[selectedCountry] || {};\n  let center = null;\n  if (selectedCountryObj) {\n    center = selectedCountryObj.latlng;\n  }\n\n  return (\n    <div className=\"App\">\n      { isFetching && <Loader />}\n      { !isFetching && (\n        <>\n          <div className=\"flex-container\">\n            <div className=\"column flag-display\">\n              <>\n                <img id=\"flag\" width=\"250\" src={selectedCountryObj?.flag} />\n                <Country country={selectedCountryObj} />\n              </>\n            </div>\n            {center && <Map\n              country={selectedCountryObj}\n              latitude={center[0]}\n              longitude={center[1]}\n            /> }\n            <div className=\"column country-list\">\n              <Typeahead\n                options={countryNameList}\n                selectedCountry={selectedCountry}\n                setSelectedCountry={setSelectedCountry}\n              />\n            </div>\n          </div>\n        </>\n      )}\n    </div>\n  );\n};\n\nexport default App;\n","export const API_BASE_URL = \"https://restcountries.eu/rest/v2\"\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n// reportWebVitals();\n"],"sourceRoot":""}